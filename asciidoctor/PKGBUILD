
pkgname=asciidoctor
pkgver=2.0.21
_rubyver=3.2.3
pkgrel=1
pkgdesc='Text processor and publishing toolchain for converting AsciiDoc content to HTML5, DocBook, PDF, and other formats.'
arch=('x86_64')
url='https://asciidoctor.org'
license=('MIT')
depends=('ruby')
source=("https://rubygems.org/downloads/${pkgname}-${pkgver}.gem")
noextract=("${pkgname}-${pkgver}.gem")
sha256sums=('07138c69d2aa320932d38beb17fedb09090cdb38e64d14c1f6926b620715c100')

package() {
    gem install --ignore-dependencies --no-user-install -V \
        -i ${pkgdir}/usr/lib/ruby/gems/${_rubyver}/ -n ${pkgdir}/usr/bin \
        ${pkgname}-${pkgver}.gem

    install -Dm644 ${pkgdir}/usr/lib/ruby/gems/${_rubyver}/gems/${pkgname}-${pkgver}/LICENSE \
        ${pkgdir}/usr/share/licenses/${pkgname}/LICENSE
        
    install -Dm644 ${pkgdir}/usr/lib/ruby/gems/${_rubyver}/gems/${pkgname}-${pkgver}/man/asciidoctor.1 \
        ${pkgdir}/usr/share/man/man1/asciidoctor.1

    rm ${pkgdir}/usr/lib/ruby/gems/${_rubyver}/cache/${pkgname}-${pkgver}.gem
    rm -rf ${pkgdir}/usr/lib/ruby/gems/${_rubyver}/gems/${pkgname}-${pkgver}/man
}
